<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D&D Digital - Combat VFX Prototype</title>
  <style>
    :root {
      --bg-dark: #0F0D13;
      --bg-surface: #1E1B26;
      --gold-primary: #F59E0B;
      --purple-primary: #8B5CF6;
      --green-success: #22C55E;
      --red-danger: #EF4444;
      --blue-info: #3B82F6;
      --text-primary: #F4F4F5;
      --text-secondary: #A1A1AA;
      
      --damage-fire: #FF6B35;
      --damage-cold: #60A5FA;
      --damage-lightning: #FBBF24;
      --damage-necrotic: #9333EA;
      --damage-radiant: #FEF3C7;
      --damage-physical: #EF4444;
      --damage-heal: #22C55E;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      overflow: hidden;
    }

    .demo-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: 16px 24px;
      background: rgba(15, 13, 19, 0.9);
      backdrop-filter: blur(10px);
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .demo-title {
      font-family: 'Cinzel', serif;
      font-size: 1.25rem;
      color: var(--gold-primary);
    }

    .demo-controls {
      display: flex;
      gap: 8px;
    }

    .demo-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.875rem;
    }

    .demo-btn.fire { background: var(--damage-fire); color: white; }
    .demo-btn.cold { background: var(--damage-cold); color: black; }
    .demo-btn.lightning { background: var(--damage-lightning); color: black; }
    .demo-btn.necrotic { background: var(--damage-necrotic); color: white; }
    .demo-btn.radiant { background: var(--damage-radiant); color: black; }
    .demo-btn.physical { background: var(--damage-physical); color: white; }
    .demo-btn.heal { background: var(--damage-heal); color: white; }
    .demo-btn.crit { background: linear-gradient(135deg, var(--gold-primary), #FF6B35); color: black; }

    .demo-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    /* Combat Arena */
    .combat-arena {
      position: relative;
      width: 100%;
      height: 100vh;
      background: 
        radial-gradient(ellipse at 30% 70%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
        radial-gradient(ellipse at 70% 30%, rgba(245, 158, 11, 0.1) 0%, transparent 50%),
        var(--bg-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 200px;
    }

    /* Combatants */
    .combatant {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .combatant-avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      position: relative;
      transition: all 0.3s ease;
    }

    .combatant.player .combatant-avatar {
      background: linear-gradient(135deg, #22C55E, #16A34A);
      border: 4px solid #22C55E;
      box-shadow: 0 0 30px rgba(34, 197, 94, 0.3);
    }

    .combatant.enemy .combatant-avatar {
      background: linear-gradient(135deg, #EF4444, #B91C1C);
      border: 4px solid #EF4444;
      box-shadow: 0 0 30px rgba(239, 68, 68, 0.3);
    }

    .combatant-name {
      margin-top: 16px;
      font-family: 'Cinzel', serif;
      font-size: 1.25rem;
      color: var(--text-primary);
    }

    /* Health Bar */
    .health-bar-container {
      margin-top: 12px;
      width: 150px;
    }

    .health-bar-bg {
      width: 100%;
      height: 12px;
      background: var(--bg-surface);
      border-radius: 6px;
      overflow: hidden;
      position: relative;
    }

    .health-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--red-danger), var(--green-success));
      border-radius: 6px;
      transition: width 0.5s ease;
      position: relative;
    }

    .health-bar-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(180deg, rgba(255,255,255,0.3), transparent);
    }

    .health-text {
      text-align: center;
      font-size: 0.875rem;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    /* Damage Numbers */
    .damage-number {
      position: absolute;
      font-family: 'Cinzel', serif;
      font-weight: 900;
      font-size: 2rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 20px currentColor;
      pointer-events: none;
      z-index: 50;
      animation: damageFloat 1.5s ease-out forwards;
    }

    @keyframes damageFloat {
      0% {
        opacity: 1;
        transform: translateY(0) scale(0.5);
      }
      20% {
        transform: translateY(-20px) scale(1.2);
      }
      100% {
        opacity: 0;
        transform: translateY(-80px) scale(0.8);
      }
    }

    .damage-number.crit {
      font-size: 3.5rem;
      animation: critFloat 2s ease-out forwards;
    }

    @keyframes critFloat {
      0% {
        opacity: 1;
        transform: translateY(0) scale(0.3) rotate(-10deg);
      }
      15% {
        transform: translateY(-30px) scale(1.5) rotate(5deg);
      }
      30% {
        transform: translateY(-40px) scale(1.3) rotate(-3deg);
      }
      100% {
        opacity: 0;
        transform: translateY(-120px) scale(0.6) rotate(0deg);
      }
    }

    .damage-number.heal {
      color: var(--damage-heal) !important;
    }

    .damage-number.heal::before {
      content: '+';
    }

    /* Status Text */
    .status-text {
      position: absolute;
      font-weight: 700;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      pointer-events: none;
      animation: statusFloat 1.2s ease-out forwards;
    }

    @keyframes statusFloat {
      0% {
        opacity: 1;
        transform: translateY(0) scale(0.8);
      }
      20% {
        transform: translateY(-15px) scale(1.1);
      }
      100% {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
      }
    }

    .status-text.miss { color: #9CA3AF; }
    .status-text.immune { color: #60A5FA; }
    .status-text.resist { color: #FBBF24; }

    /* Hit Effects */
    .hit-flash {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
      animation: hitFlash 0.3s ease-out forwards;
      pointer-events: none;
    }

    @keyframes hitFlash {
      0% { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: scale(1.5); }
    }

    .shake {
      animation: shake 0.4s ease-out;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-10px); }
      40% { transform: translateX(10px); }
      60% { transform: translateX(-5px); }
      80% { transform: translateX(5px); }
    }

    /* Spell Effects Container */
    .spell-effect {
      position: absolute;
      pointer-events: none;
      z-index: 40;
    }

    /* Fire Effect */
    .fire-effect {
      width: 150px;
      height: 150px;
    }

    .fire-particle {
      position: absolute;
      border-radius: 50%;
      animation: fireParticle 0.8s ease-out forwards;
    }

    @keyframes fireParticle {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-60px) scale(0);
      }
    }

    /* Cold Effect */
    .cold-effect {
      width: 150px;
      height: 150px;
    }

    .frost-particle {
      position: absolute;
      color: var(--damage-cold);
      font-size: 1.5rem;
      animation: frostParticle 1s ease-out forwards;
    }

    @keyframes frostParticle {
      0% {
        opacity: 1;
        transform: translate(0, 0) rotate(0deg) scale(0);
      }
      50% {
        opacity: 1;
        transform: translate(var(--tx), var(--ty)) rotate(180deg) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(var(--tx2), var(--ty2)) rotate(360deg) scale(0.5);
      }
    }

    /* Lightning Effect */
    .lightning-effect {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .lightning-bolt {
      position: absolute;
      background: var(--damage-lightning);
      filter: blur(2px);
      animation: lightningFlash 0.15s ease-out;
    }

    @keyframes lightningFlash {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }

    /* Necrotic Effect */
    .necrotic-effect {
      width: 150px;
      height: 150px;
    }

    .necrotic-particle {
      position: absolute;
      width: 20px;
      height: 20px;
      background: var(--damage-necrotic);
      border-radius: 50%;
      filter: blur(5px);
      animation: necroticParticle 1.2s ease-out forwards;
    }

    @keyframes necroticParticle {
      0% {
        opacity: 0.8;
        transform: translate(0, 0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(0);
      }
    }

    /* Radiant Effect */
    .radiant-effect {
      width: 200px;
      height: 200px;
    }

    .radiant-ring {
      position: absolute;
      border: 3px solid var(--damage-radiant);
      border-radius: 50%;
      animation: radiantRing 0.8s ease-out forwards;
    }

    @keyframes radiantRing {
      0% {
        opacity: 1;
        transform: scale(0);
      }
      100% {
        opacity: 0;
        transform: scale(2);
      }
    }

    .radiant-ray {
      position: absolute;
      background: var(--damage-radiant);
      transform-origin: center;
      animation: radiantRay 0.6s ease-out forwards;
    }

    @keyframes radiantRay {
      0% {
        opacity: 1;
        transform: scaleY(0);
      }
      50% {
        opacity: 1;
        transform: scaleY(1);
      }
      100% {
        opacity: 0;
        transform: scaleY(1);
      }
    }

    /* Physical Hit */
    .slash-effect {
      position: absolute;
      width: 100px;
      height: 100px;
    }

    .slash-line {
      position: absolute;
      background: linear-gradient(90deg, transparent, white, transparent);
      height: 4px;
      animation: slashLine 0.3s ease-out forwards;
    }

    @keyframes slashLine {
      0% {
        opacity: 1;
        transform: scaleX(0) rotate(var(--rotate));
      }
      50% {
        opacity: 1;
        transform: scaleX(1) rotate(var(--rotate));
      }
      100% {
        opacity: 0;
        transform: scaleX(1) rotate(var(--rotate));
      }
    }

    /* Heal Effect */
    .heal-effect {
      width: 150px;
      height: 150px;
    }

    .heal-particle {
      position: absolute;
      font-size: 1.5rem;
      animation: healParticle 1.5s ease-out forwards;
    }

    @keyframes healParticle {
      0% {
        opacity: 1;
        transform: translateY(50px) scale(0);
      }
      50% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-50px) scale(0.5);
      }
    }

    /* Critical Hit Overlay */
    .crit-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at center, rgba(245, 158, 11, 0.3), transparent 70%);
      pointer-events: none;
      animation: critOverlay 0.5s ease-out forwards;
      z-index: 30;
    }

    @keyframes critOverlay {
      0% { opacity: 1; }
      100% { opacity: 0; }
    }

    .crit-text {
      position: fixed;
      top: 30%;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'Cinzel', serif;
      font-size: 4rem;
      font-weight: 900;
      color: var(--gold-primary);
      text-shadow: 0 0 20px var(--gold-primary), 0 0 40px var(--gold-primary);
      animation: critText 1.5s ease-out forwards;
      z-index: 60;
    }

    @keyframes critText {
      0% {
        opacity: 0;
        transform: translateX(-50%) scale(0.5) rotate(-10deg);
      }
      20% {
        opacity: 1;
        transform: translateX(-50%) scale(1.2) rotate(5deg);
      }
      40% {
        transform: translateX(-50%) scale(1) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateX(-50%) scale(0.8) translateY(-50px);
      }
    }

    /* Combat Log */
    .combat-log {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 350px;
      max-height: 300px;
      background: rgba(30, 27, 38, 0.95);
      border-radius: 16px;
      border: 1px solid rgba(139, 92, 246, 0.3);
      overflow: hidden;
      z-index: 100;
    }

    .combat-log-header {
      padding: 12px 16px;
      background: var(--bg-surface);
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      color: var(--purple-primary);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .combat-log-entries {
      padding: 12px;
      max-height: 250px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .log-entry {
      padding: 10px 12px;
      background: var(--bg-surface);
      border-radius: 8px;
      font-size: 0.875rem;
      animation: logEntrySlide 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      border-left: 3px solid;
    }

    @keyframes logEntrySlide {
      0% {
        opacity: 0;
        transform: translateX(50px);
      }
      100% {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .log-entry.damage { border-color: var(--red-danger); }
    .log-entry.heal { border-color: var(--green-success); }
    .log-entry.crit { 
      border-color: var(--gold-primary);
      background: linear-gradient(90deg, rgba(245, 158, 11, 0.2), var(--bg-surface));
    }
    .log-entry.miss { border-color: var(--text-secondary); }

    .log-entry-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    .log-actor {
      font-weight: 600;
      color: var(--text-primary);
    }

    .log-time {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .log-message {
      color: var(--text-secondary);
    }

    .log-damage {
      font-weight: 700;
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: 4px;
    }

    .log-damage.fire { background: rgba(255, 107, 53, 0.3); color: var(--damage-fire); }
    .log-damage.cold { background: rgba(96, 165, 250, 0.3); color: var(--damage-cold); }
    .log-damage.lightning { background: rgba(251, 191, 36, 0.3); color: var(--damage-lightning); }
    .log-damage.necrotic { background: rgba(147, 51, 234, 0.3); color: var(--damage-necrotic); }
    .log-damage.radiant { background: rgba(254, 243, 199, 0.3); color: #B45309; }
    .log-damage.physical { background: rgba(239, 68, 68, 0.3); color: var(--damage-physical); }
    .log-damage.heal { background: rgba(34, 197, 94, 0.3); color: var(--damage-heal); }

    /* Screen Shake */
    .screen-shake {
      animation: screenShake 0.3s ease-out;
    }

    @keyframes screenShake {
      0%, 100% { transform: translate(0, 0); }
      20% { transform: translate(-5px, 3px); }
      40% { transform: translate(5px, -3px); }
      60% { transform: translate(-3px, 2px); }
      80% { transform: translate(3px, -2px); }
    }
  </style>
</head>
<body>
  <div class="demo-header">
    <h1 class="demo-title">‚öîÔ∏è Combat VFX Demo</h1>
    <div class="demo-controls">
      <button class="demo-btn physical" onclick="triggerAttack('physical')">‚öîÔ∏è Slash</button>
      <button class="demo-btn fire" onclick="triggerAttack('fire')">üî• Fire</button>
      <button class="demo-btn cold" onclick="triggerAttack('cold')">‚ùÑÔ∏è Cold</button>
      <button class="demo-btn lightning" onclick="triggerAttack('lightning')">‚ö° Lightning</button>
      <button class="demo-btn necrotic" onclick="triggerAttack('necrotic')">üíÄ Necrotic</button>
      <button class="demo-btn radiant" onclick="triggerAttack('radiant')">‚ú® Radiant</button>
      <button class="demo-btn heal" onclick="triggerHeal()">üíö Heal</button>
      <button class="demo-btn crit" onclick="triggerCrit()">üí• CRIT!</button>
    </div>
  </div>

  <div class="combat-arena" id="arena">
    <!-- Player -->
    <div class="combatant player" id="player">
      <div class="combatant-avatar">
        üßô
      </div>
      <div class="combatant-name">Lyralei</div>
      <div class="health-bar-container">
        <div class="health-bar-bg">
          <div class="health-bar-fill" id="playerHealth" style="width: 100%;"></div>
        </div>
        <div class="health-text"><span id="playerHpCurrent">45</span> / 45 HP</div>
      </div>
    </div>

    <!-- Enemy -->
    <div class="combatant enemy" id="enemy">
      <div class="combatant-avatar">
        üêâ
      </div>
      <div class="combatant-name">Young Dragon</div>
      <div class="health-bar-container">
        <div class="health-bar-bg">
          <div class="health-bar-fill" id="enemyHealth" style="width: 100%;"></div>
        </div>
        <div class="health-text"><span id="enemyHpCurrent">120</span> / 120 HP</div>
      </div>
    </div>
  </div>

  <!-- Combat Log -->
  <div class="combat-log">
    <div class="combat-log-header">üìú Combat Log</div>
    <div class="combat-log-entries" id="logEntries">
      <div class="log-entry damage">
        <div class="log-entry-header">
          <span class="log-actor">Combat Started</span>
          <span class="log-time">0:00</span>
        </div>
        <div class="log-message">Roll for initiative!</div>
      </div>
    </div>
  </div>

  <script>
    const arena = document.getElementById('arena');
    const enemy = document.getElementById('enemy');
    const player = document.getElementById('player');
    const enemyHealth = document.getElementById('enemyHealth');
    const playerHealth = document.getElementById('playerHealth');
    const enemyHpCurrent = document.getElementById('enemyHpCurrent');
    const playerHpCurrent = document.getElementById('playerHpCurrent');
    const logEntries = document.getElementById('logEntries');

    let enemyHp = 120;
    let playerHp = 45;
    let time = 0;

    const damageColors = {
      fire: 'var(--damage-fire)',
      cold: 'var(--damage-cold)',
      lightning: 'var(--damage-lightning)',
      necrotic: 'var(--damage-necrotic)',
      radiant: 'var(--damage-radiant)',
      physical: 'var(--damage-physical)',
      heal: 'var(--damage-heal)'
    };

    function rollDamage(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function createDamageNumber(target, damage, type, isCrit = false, isHeal = false) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const num = document.createElement('div');
      num.className = `damage-number ${isCrit ? 'crit' : ''} ${isHeal ? 'heal' : ''}`;
      num.textContent = damage;
      num.style.color = damageColors[type];
      num.style.left = rect.left + rect.width/2 - 30 + Math.random() * 60 + 'px';
      num.style.top = rect.top + 'px';
      
      document.body.appendChild(num);
      setTimeout(() => num.remove(), 2000);
    }

    function createStatusText(target, text, type) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const status = document.createElement('div');
      status.className = `status-text ${type}`;
      status.textContent = text;
      status.style.left = rect.left + rect.width/2 - 30 + 'px';
      status.style.top = rect.top + 30 + 'px';
      
      document.body.appendChild(status);
      setTimeout(() => status.remove(), 1500);
    }

    function createHitFlash(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const flash = document.createElement('div');
      flash.className = 'hit-flash';
      avatar.appendChild(flash);
      setTimeout(() => flash.remove(), 300);
    }

    function shakeTarget(target) {
      target.classList.add('shake');
      setTimeout(() => target.classList.remove('shake'), 400);
    }

    function shakeScreen() {
      arena.classList.add('screen-shake');
      setTimeout(() => arena.classList.remove('screen-shake'), 300);
    }

    function updateHealth(target, damage, isHeal = false) {
      if (target === enemy) {
        if (isHeal) {
          enemyHp = Math.min(120, enemyHp + damage);
        } else {
          enemyHp = Math.max(0, enemyHp - damage);
        }
        enemyHealth.style.width = (enemyHp / 120 * 100) + '%';
        enemyHpCurrent.textContent = enemyHp;
      } else {
        if (isHeal) {
          playerHp = Math.min(45, playerHp + damage);
        } else {
          playerHp = Math.max(0, playerHp - damage);
        }
        playerHealth.style.width = (playerHp / 45 * 100) + '%';
        playerHpCurrent.textContent = playerHp;
      }
    }

    function addLogEntry(actor, message, type, damage = null, damageType = null) {
      time++;
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      
      let damageHtml = '';
      if (damage !== null) {
        damageHtml = `<span class="log-damage ${damageType}">${damage}</span>`;
      }
      
      entry.innerHTML = `
        <div class="log-entry-header">
          <span class="log-actor">${actor}</span>
          <span class="log-time">0:${time.toString().padStart(2, '0')}</span>
        </div>
        <div class="log-message">${message}${damageHtml}</div>
      `;
      
      logEntries.insertBefore(entry, logEntries.children[1] || null);
      
      // Keep only last 10 entries
      while (logEntries.children.length > 11) {
        logEntries.removeChild(logEntries.lastChild);
      }
    }

    // Spell Effects
    function createFireEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const effect = document.createElement('div');
      effect.className = 'spell-effect fire-effect';
      effect.style.left = rect.left - 15 + 'px';
      effect.style.top = rect.top - 15 + 'px';
      
      for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'fire-particle';
        particle.style.left = 50 + Math.random() * 50 + 'px';
        particle.style.top = 100 + Math.random() * 50 + 'px';
        particle.style.width = 10 + Math.random() * 20 + 'px';
        particle.style.height = particle.style.width;
        particle.style.background = `radial-gradient(circle, ${Math.random() > 0.5 ? '#FF6B35' : '#FBBF24'}, transparent)`;
        particle.style.animationDelay = Math.random() * 0.3 + 's';
        effect.appendChild(particle);
      }
      
      document.body.appendChild(effect);
      setTimeout(() => effect.remove(), 1000);
    }

    function createColdEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const effect = document.createElement('div');
      effect.className = 'spell-effect cold-effect';
      effect.style.left = rect.left - 15 + 'px';
      effect.style.top = rect.top - 15 + 'px';
      
      const snowflakes = ['‚ùÑ', '‚ùÖ', '‚ùÜ', '‚úª', '‚úº'];
      for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.className = 'frost-particle';
        particle.textContent = snowflakes[Math.floor(Math.random() * snowflakes.length)];
        particle.style.left = 75 + 'px';
        particle.style.top = 75 + 'px';
        particle.style.setProperty('--tx', (Math.random() - 0.5) * 100 + 'px');
        particle.style.setProperty('--ty', (Math.random() - 0.5) * 100 + 'px');
        particle.style.setProperty('--tx2', (Math.random() - 0.5) * 150 + 'px');
        particle.style.setProperty('--ty2', (Math.random() - 0.5) * 150 + 'px');
        particle.style.animationDelay = Math.random() * 0.2 + 's';
        effect.appendChild(particle);
      }
      
      document.body.appendChild(effect);
      setTimeout(() => effect.remove(), 1200);
    }

    function createLightningEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      for (let flash = 0; flash < 3; flash++) {
        setTimeout(() => {
          const effect = document.createElement('div');
          effect.className = 'spell-effect lightning-effect';
          effect.style.left = rect.left + 'px';
          effect.style.top = rect.top - 200 + 'px';
          effect.style.width = rect.width + 'px';
          effect.style.height = '300px';
          
          // Create jagged lightning bolt
          let x = rect.width / 2;
          let y = 0;
          
          for (let i = 0; i < 8; i++) {
            const bolt = document.createElement('div');
            bolt.className = 'lightning-bolt';
            const newX = x + (Math.random() - 0.5) * 40;
            const newY = y + 40;
            
            const angle = Math.atan2(newY - y, newX - x);
            const length = Math.sqrt(Math.pow(newX - x, 2) + Math.pow(newY - y, 2));
            
            bolt.style.left = x + 'px';
            bolt.style.top = y + 'px';
            bolt.style.width = length + 'px';
            bolt.style.height = '3px';
            bolt.style.transform = `rotate(${angle}rad)`;
            bolt.style.transformOrigin = 'left center';
            
            effect.appendChild(bolt);
            x = newX;
            y = newY;
          }
          
          document.body.appendChild(effect);
          setTimeout(() => effect.remove(), 200);
        }, flash * 100);
      }
    }

    function createNecroticEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const effect = document.createElement('div');
      effect.className = 'spell-effect necrotic-effect';
      effect.style.left = rect.left - 15 + 'px';
      effect.style.top = rect.top - 15 + 'px';
      
      for (let i = 0; i < 12; i++) {
        const particle = document.createElement('div');
        particle.className = 'necrotic-particle';
        particle.style.left = 65 + 'px';
        particle.style.top = 65 + 'px';
        particle.style.setProperty('--tx', (Math.random() - 0.5) * 80 + 'px');
        particle.style.setProperty('--ty', (Math.random() - 0.5) * 80 + 'px');
        particle.style.animationDelay = Math.random() * 0.3 + 's';
        effect.appendChild(particle);
      }
      
      document.body.appendChild(effect);
      setTimeout(() => effect.remove(), 1500);
    }

    function createRadiantEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const effect = document.createElement('div');
      effect.className = 'spell-effect radiant-effect';
      effect.style.left = rect.left - 40 + 'px';
      effect.style.top = rect.top - 40 + 'px';
      
      // Rings
      for (let i = 0; i < 3; i++) {
        const ring = document.createElement('div');
        ring.className = 'radiant-ring';
        ring.style.left = 50 + 'px';
        ring.style.top = 50 + 'px';
        ring.style.width = 100 + 'px';
        ring.style.height = 100 + 'px';
        ring.style.marginLeft = '-50px';
        ring.style.marginTop = '-50px';
        ring.style.animationDelay = i * 0.2 + 's';
        effect.appendChild(ring);
      }
      
      // Rays
      for (let i = 0; i < 8; i++) {
        const ray = document.createElement('div');
        ray.className = 'radiant-ray';
        ray.style.left = 98 + 'px';
        ray.style.top = 100 + 'px';
        ray.style.width = '4px';
        ray.style.height = '50px';
        ray.style.transform = `rotate(${i * 45}deg)`;
        ray.style.transformOrigin = 'center 0';
        ray.style.animationDelay = i * 0.05 + 's';
        effect.appendChild(ray);
      }
      
      document.body.appendChild(effect);
      setTimeout(() => effect.remove(), 1000);
    }

    function createSlashEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const effect = document.createElement('div');
      effect.className = 'spell-effect slash-effect';
      effect.style.left = rect.left + 10 + 'px';
      effect.style.top = rect.top + 10 + 'px';
      
      for (let i = 0; i < 3; i++) {
        const slash = document.createElement('div');
        slash.className = 'slash-line';
        slash.style.left = 50 + 'px';
        slash.style.top = 30 + i * 20 + 'px';
        slash.style.width = '80px';
        slash.style.setProperty('--rotate', (-30 + i * 15) + 'deg');
        slash.style.animationDelay = i * 0.1 + 's';
        effect.appendChild(slash);
      }
      
      document.body.appendChild(effect);
      setTimeout(() => effect.remove(), 500);
    }

    function createHealEffect(target) {
      const avatar = target.querySelector('.combatant-avatar');
      const rect = avatar.getBoundingClientRect();
      
      const effect = document.createElement('div');
      effect.className = 'spell-effect heal-effect';
      effect.style.left = rect.left - 15 + 'px';
      effect.style.top = rect.top - 15 + 'px';
      
      const symbols = ['üíö', '‚ú®', 'üåü', '+', '‚ù§Ô∏è‚Äçü©π'];
      for (let i = 0; i < 10; i++) {
        const particle = document.createElement('div');
        particle.className = 'heal-particle';
        particle.textContent = symbols[Math.floor(Math.random() * symbols.length)];
        particle.style.left = 30 + Math.random() * 90 + 'px';
        particle.style.top = 75 + 'px';
        particle.style.animationDelay = Math.random() * 0.5 + 's';
        effect.appendChild(particle);
      }
      
      document.body.appendChild(effect);
      setTimeout(() => effect.remove(), 2000);
    }

    function createCritOverlay() {
      const overlay = document.createElement('div');
      overlay.className = 'crit-overlay';
      document.body.appendChild(overlay);
      setTimeout(() => overlay.remove(), 500);
      
      const text = document.createElement('div');
      text.className = 'crit-text';
      text.textContent = 'CRITICAL HIT!';
      document.body.appendChild(text);
      setTimeout(() => text.remove(), 1500);
    }

    // Main attack function
    function triggerAttack(type) {
      const damage = rollDamage(8, 24);
      
      // Visual effects by type
      switch(type) {
        case 'fire': createFireEffect(enemy); break;
        case 'cold': createColdEffect(enemy); break;
        case 'lightning': createLightningEffect(enemy); break;
        case 'necrotic': createNecroticEffect(enemy); break;
        case 'radiant': createRadiantEffect(enemy); break;
        case 'physical': createSlashEffect(enemy); break;
      }
      
      setTimeout(() => {
        createHitFlash(enemy);
        shakeTarget(enemy);
        createDamageNumber(enemy, damage, type);
        updateHealth(enemy, damage);
        
        const typeNames = {
          fire: 'Fire', cold: 'Cold', lightning: 'Lightning',
          necrotic: 'Necrotic', radiant: 'Radiant', physical: 'Slashing'
        };
        addLogEntry('Lyralei', `deals ${typeNames[type]} damage`, 'damage', damage, type);
      }, 200);
    }

    function triggerHeal() {
      const heal = rollDamage(12, 20);
      
      createHealEffect(player);
      
      setTimeout(() => {
        createDamageNumber(player, heal, 'heal', false, true);
        updateHealth(player, heal, true);
        addLogEntry('Lyralei', `heals for`, 'heal', heal, 'heal');
      }, 500);
    }

    function triggerCrit() {
      const damage = rollDamage(30, 48);
      
      createCritOverlay();
      createFireEffect(enemy);
      createRadiantEffect(enemy);
      shakeScreen();
      
      setTimeout(() => {
        createHitFlash(enemy);
        shakeTarget(enemy);
        createDamageNumber(enemy, damage, 'physical', true);
        updateHealth(enemy, damage);
        addLogEntry('Lyralei', `CRITICAL HIT! Deals massive damage`, 'crit', damage, 'physical');
      }, 300);
    }
  </script>
</body>
</html>
